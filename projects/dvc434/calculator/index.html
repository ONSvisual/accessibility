<!DOCTYPE html>
<html lang="en">

<head>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600|Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
    <title>Extension value calculator</title>

    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <link rel="stylesheet" href="../lib/globalStyle.css"/>
    <link rel="stylesheet" href="css/chosen.css"/>
    <link rel="stylesheet" type="text/css" href="css/odometer-theme-default.css">
    <style type="text/css">

	body {
		display:block;
		overflow:auto;
		margin-bottom:60px;
		margin-left:0px;
		padding-bottom:60px;
		max-width:auto;
		min-height:564px;
		font-size:16px;
	}
	.picaarticle {
	   font-size:14px;
	}

    #pcGo:hover {
        cursor:pointer;
        cursor:hand;
    }

    .inputOption{
		height:25px;
		margin-top:20px;
		padding-left:10px;
		background-color:white!important;
	}

	input:-webkit-autofill, textarea:-webkit-autofill, select:-webkit-autofill {
		-webkit-box-shadow: 0 0 0px 1000px white inset;
	}

	.useLocation {
		cursor:pointer;
		cursor:hand;
		background-color:#274796!important;
	}

	/*Bootstrap grid */
	.row {
	/*  margin-left: -15px;*/
	/*  margin-right: -15px;*/
	}
	.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
	  position: relative;
	  min-height: 1px;
	  /*padding-left: 15px;*/
	  /*padding-right: 15px;*/
	}
	.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
	  float: left;
	}
	.col-xs-12 {
	  width: 100%;
	}
	.col-xs-11 {
	  width: 91.66666667%;
	}
	.col-xs-10 {
	  width: 83.33333333%;
	}
	.col-xs-9 {
	  width: 75%;
	}
	.col-xs-8 {
	  width: 66.66666667%;
	}
	.col-xs-7 {
	  width: 58.33333333%;
	}
	.col-xs-6 {
	  width: 50%;
	}
	.col-xs-5 {
	  width: 41.66666667%;
	}
	.col-xs-4 {
	  width: 33.33333333%;
	}
	.col-xs-3 {
	  width: 25%;
	}
	.col-xs-2 {
	  width: 16.66666667%;
	}
	.col-xs-1 {
	  width: 8.33333333%;
	}
	.col-xs-pull-12 {
	  right: 100%;
	}
	.col-xs-pull-11 {
	  right: 91.66666667%;
	}
	.col-xs-pull-10 {
	  right: 83.33333333%;
	}
	.col-xs-pull-9 {
	  right: 75%;
	}
	.col-xs-pull-8 {
	  right: 66.66666667%;
	}
	.col-xs-pull-7 {
	  right: 58.33333333%;
	}
	.col-xs-pull-6 {
	  right: 50%;
	}
	.col-xs-pull-5 {
	  right: 41.66666667%;
	}
	.col-xs-pull-4 {
	  right: 33.33333333%;
	}
	.col-xs-pull-3 {
	  right: 25%;
	}
	.col-xs-pull-2 {
	  right: 16.66666667%;
	}
	.col-xs-pull-1 {
	  right: 8.33333333%;
	}
	.col-xs-pull-0 {
	  right: auto;
	}
	.col-xs-push-12 {
	  left: 100%;
	}
	.col-xs-push-11 {
	  left: 91.66666667%;
	}
	.col-xs-push-10 {
	  left: 83.33333333%;
	}
	.col-xs-push-9 {
	  left: 75%;
	}
	.col-xs-push-8 {
	  left: 66.66666667%;
	}
	.col-xs-push-7 {
	  left: 58.33333333%;
	}
	.col-xs-push-6 {
	  left: 50%;
	}
	.col-xs-push-5 {
	  left: 41.66666667%;
	}
	.col-xs-push-4 {
	  left: 33.33333333%;
	}
	.col-xs-push-3 {
	  left: 25%;
	}
	.col-xs-push-2 {
	  left: 16.66666667%;
	}
	.col-xs-push-1 {
	  left: 8.33333333%;
	}
	.col-xs-push-0 {
	  left: auto;
	}
	.col-xs-offset-12 {
	  margin-left: 100%;
	}
	.col-xs-offset-11 {
	  margin-left: 91.66666667%;
	}
	.col-xs-offset-10 {
	  margin-left: 83.33333333%;
	}
	.col-xs-offset-9 {
	  margin-left: 75%;
	}
	.col-xs-offset-8 {
	  margin-left: 66.66666667%;
	}
	.col-xs-offset-7 {
	  margin-left: 58.33333333%;
	}
	.col-xs-offset-6 {
	  margin-left: 50%;
	}
	.col-xs-offset-5 {
	  margin-left: 41.66666667%;
	}
	.col-xs-offset-4 {
	  margin-left: 33.33333333%;
	}
	.col-xs-offset-3 {
	  margin-left: 25%;
	}
	.col-xs-offset-2 {
	  margin-left: 16.66666667%;
	}
	.col-xs-offset-1 {
	  margin-left: 8.33333333%;
	}
	.col-xs-offset-0 {
	  margin-left: 0%;
	}
	@media (min-width: 550px) {
	  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
		float: left;
	  }
	  .col-sm-12 {
		width: 100%;
	  }
	  .col-sm-11 {
		width: 91.66666667%;
	  }
	  .col-sm-10 {
		width: 83.33333333%;
	  }
	  .col-sm-9 {
		width: 75%;
	  }
	  .col-sm-8 {
		width: 66.66666667%;
	  }
	  .col-sm-7 {
		width: 58.33333333%;
	  }
	  .col-sm-6 {
		width: 50%;
	  }
	  .col-sm-5 {
		width: 41.66666667%;
	  }
	  .col-sm-4 {
		width: 33.33333333%;
	  }
	  .col-sm-3 {
		width: 25%;
	  }
	  .col-sm-2 {
		width: 16.66666667%;
	  }
	  .col-sm-1 {
		width: 8.33333333%;
	  }
	  .col-sm-pull-12 {
		right: 100%;
	  }
	  .col-sm-pull-11 {
		right: 91.66666667%;
	  }
	  .col-sm-pull-10 {
		right: 83.33333333%;
	  }
	  .col-sm-pull-9 {
		right: 75%;
	  }
	  .col-sm-pull-8 {
		right: 66.66666667%;
	  }
	  .col-sm-pull-7 {
		right: 58.33333333%;
	  }
	  .col-sm-pull-6 {
		right: 50%;
	  }
	  .col-sm-pull-5 {

		right: 41.66666667%;
	  }
	  .col-sm-pull-4 {
		right: 33.33333333%;
	  }
	  .col-sm-pull-3 {
		right: 25%;
	  }
	  .col-sm-pull-2 {
		right: 16.66666667%;
	  }
	  .col-sm-pull-1 {
		right: 8.33333333%;
	  }
	  .col-sm-pull-0 {
		right: auto;
	  }
	  .col-sm-push-12 {
		left: 100%;
	  }
	  .col-sm-push-11 {
		left: 91.66666667%;
	  }
	  .col-sm-push-10 {
		left: 83.33333333%;
	  }
	  .col-sm-push-9 {
		left: 75%;
	  }
	  .col-sm-push-8 {
		left: 66.66666667%;
	  }
	  .col-sm-push-7 {
		left: 58.33333333%;
	  }
	  .col-sm-push-6 {
		left: 50%;
	  }
	  .col-sm-push-5 {
		left: 41.66666667%;
	  }
	  .col-sm-push-4 {
		left: 33.33333333%;
	  }
	  .col-sm-push-3 {
		left: 25%;
	  }
	  .col-sm-push-2 {
		left: 16.66666667%;
	  }
	  .col-sm-push-1 {
		left: 8.33333333%;
	  }
	  .col-sm-push-0 {
		left: auto;
	  }
	  .col-sm-offset-12 {
		margin-left: 100%;
	  }
	  .col-sm-offset-11 {
		margin-left: 91.66666667%;
	  }
	  .col-sm-offset-10 {
		margin-left: 83.33333333%;
	  }
	  .col-sm-offset-9 {
		margin-left: 75%;
	  }
	  .col-sm-offset-8 {
		margin-left: 66.66666667%;
	  }
	  .col-sm-offset-7 {
		margin-left: 58.33333333%;
	  }
	  .col-sm-offset-6 {
		margin-left: 50%;
	  }
	  .col-sm-offset-5 {
		margin-left: 41.66666667%;
	  }
	  .col-sm-offset-4 {
		margin-left: 33.33333333%;
	  }
	  .col-sm-offset-3 {
		margin-left: 25%;
	  }
	  .col-sm-offset-2 {
		margin-left: 16.66666667%;
	  }
	  .col-sm-offset-1 {
		margin-left: 8.33333333%;
	  }
	  .col-sm-offset-0 {
		margin-left: 0%;
	  }
	}

	@media (min-width: 550px) {
		.graphicslabel{
			color:grey;
			font-size:12px;
			margin-bottom:10px;
			margin-top:0px;
			font-weight:normal;
			text-align:right;
			padding-right:10px;
			padding-top:15px;
		}

	}

	@media (max-width: 550px) {
		.graphicslabel{
			color:grey;
			font-size:12px;
			margin-bottom:10px;
			margin-top:0px;
			font-weight:normal;
			text-align:left;
			padding-right:0px;
			padding-top:15px;
		}
	}

	.hoverbar{
		cursor:pointer;
		cursor:hand;
	}
	.hoverbar:hover{
		cursor:pointer;
		cursor:hand;
	}
	.hovertrick{
		cursor:pointer;
		cursor:hand;
		width:3px;
		opacity:1;
		fill:#206095;
		transform:translate(-1,0);
	}

	.container {
		overflow:hidden;
	}
	.calcTitle{
		font-size:24px;
		font-weight:bold;
		color:#206095;
		margin-bottom:10px;
	}
	.questions{
		font-size:18px;
		font-weight:bold;
		color:#206095;
		margin-bottom:10px;
	}
	.radioOption{
		margin-bottom:0px;
	}
	.statHeader{
		font-size:16px;
		color:white;
		font-weight:bold;
		padding-left:5px;
		padding-top: 5px;
		padding-bottom:5px;
		box-sizing: border-box;
    	-moz-box-sizing: border-box;
    	-webkit-box-sizing: border-box;
    	border-right: 5px solid white;
	}
	.resultNumber{
		font-size:28px;
		color:#206095;
		font-weight:bold;
		margin-top:10px;
		margin-bottom:10px;
	}
	.resultNumberEW{
		font-size:28px;
		color:#B8860B;
		font-weight:bold;
		margin-top:10px;
		margin-bottom:10px;
	}

	::-webkit-input-placeholder { /* Chrome/Opera/Safari */
	  color: #666;
	  font-weight:bold;
	  font-size:15px;
	  font-family:"Open Sans";
	}
	::-moz-placeholder { /* Firefox 19+ */
	  color: #666;
	  font-weight:bold;
	  font-size:15px;
	  font-family:"Open Sans";
	}
	:-ms-input-placeholder { /* IE 10+ */
	  color: #666;
	  font-weight:bold;
	  font-size:15px;
	  font-family:"Open Sans";
	}
	:-moz-placeholder { /* Firefox 18- */
	  color: #666;
	  font-weight:bold;
	  font-size:15px;
	  font-family:"Open Sans";
	}

	/* Redesign August 2020 */

	.header {
		display: flex;
		flex-direction: column;
		background-image: url('images/option-2.png');
		min-height: 100px;
		padding: 12px;
		margin-bottom: 10px;
	}

	.input {
		float:left;
		width: 170px;
		height: 35px;
		margin-top:0px;
		padding-left: 5px;
		color: #206095;
		background: #FFF;
		font-size: 16px;
		outline: none;
		border: 2px solid #206095;
		-moz-appearance: none;
		-webkit-appearance: none;
	}

	.input:focus,
	.btn:focus {
		box-shadow: 0 0 0px 3pt orange;
	}

	.btn {
		float: left;
		height: 41px;
		padding: 0 13px;
		border: 2px solid #206095;
		border-left: 0;
		background: #206095;
		color: white;
		font-size: 16px;
		outline: 0;
	}

	/* Utility */

	.pl-1 { padding-left: 0.25rem; }
	.pl-2 { padding-left: 0.5rem; }

	.mb-3 { margin-bottom: 0.75rem; }

	/* Accessibility */

    </style>
</head>
<body>

<div class="calcTitle" style="margin-left:0px;">Will an extension increase the value of my house?</div>

<div class="header">

    <div class="mb-3"><!--postcode input here-->
    	<form id="pcForm">
    		<input id="pcText" class="input picaarticle inputOption" type="text" placeholder="insert your postcode">
    		<button type="submit" id="pcGo" class="btn">Go</button>
    	</form>
    </div>

    <div id="occupation">
    	<!--Dropdown drawn here-->
    </div>


</div> <!--end header-->

				<div id="pcError" style="color:#972B3A;"></div><!--pcd error message-->

<div style="font-size:20px; font-weight:bold; margin-bottom:5px; margin-top:0px; clear:both; color:#206095;">How big is your extension?</div>

    <div id="roomSize" class="row" style="min-height:80px; clear:both;">
    	<div class="col-xs-12 col-sm-5">
            <form id="pcForm">
               <input style="width:147px; float:left; height:30px; font-size:18px; padding-left:5px; margin-top:15px; color:#666;" id="custom2" value="25" type="number" placeholder="Insert size" min="1" max="100" />
            </form>
        <div style="height:33px; float:left; padding-top:3px; padding-left:5px; margin-right:20px; margin-top:15px; width:30px; background-color:#206095; color:white;">m<sup>2</sup></div>
        </div>

        <div class="col-xs-12 col-sm-7" style="margin-bottom:20px;">
            <form style="margin-left:20px; margin-bottom:30px;">
              <input type="radio" class="radioOption closeCustom smExtension" name="extType" value="female"> Small (15 m<sup>2</sup>)<br>
              <input type="radio" class="radioOption closeCustom mdExtension" name="extType" checked="true" value="female"> Medium (25 m<sup>2</sup>)<br>
              <input type="radio" class="radioOption closeCustom lgExtension" name="extType" value="female"> Large (35 m<sup>2</sup>)<br>
            </form>
        </div>
    </div>

    <div style="font-size:20px; font-weight:bold; margin-bottom:5px; margin-top:0px; color:#206095;">Your extension could be worth...</div>

    <div id="answerArray" class="row" style="clear:both; min-height:90px;">
    	<div class="col-xs-12 col-sm-6">
        	<div class="statHeader" id="yourAreaName" style="width:100%; background-color:#206095;">Fareham</div>
            	<div id="yourAreaValue" class="odometer resultNumber" style="width:100%;">£34,272</div>
        </div>
        <div class="col-xs-12 col-sm-6">
        	<div class="statHeader" style="width:100%; background-color:#B8860B">England and Wales</div>
            	<div id="EWAreaValue" class="odometer resultNumberEW" style="width:100%;">£28,356</div>
        </div>
       <!-- <div class="col-xs-12 col-sm-6">
        	<div class="statHeader" style="width:100%; background-color:#206095;">Kensington & Chelsea (highest)</div>
            	<div id="TopAreaValue" class="odometer resultNumber" style="width:100%;">£215,856</div>
        </div>
        <div class="col-xs-12 col-sm-6">
        	<div class="statHeader" style="width:100%; background-color:#206095;">Blenau Gwent (lowest)</div>
            	<div id="BotAreaValue" class="odometer resultNumber" style="width:100%;">£9,300</div>
        </div>-->
    </div>

    <!--__________--><div style="height:2px; clear:both; width:100%; background-color:#206095; margin-bottom:10px;"></div>

    <div style="font-size:20px; font-weight:bold; margin-bottom:5px; color:#206095;"><span id="m2AreaName"></span>price per m<sup>2</sup></div>
    <div id="yourAreaM2Value" class="odometer" style="font-size:28px; font-weight:bold; color:#206095;"></div>

    <div id="incomeOf" class="resultsChart" style="margin-bottom:0px; margin-top:5px;"></div>

    <div id="footer" style="margin-top:20px;"></div>
        

    
    <script src="https://cdn.ons.gov.uk/vendor/d3/3.5.17/d3.min.js" type="text/javascript"></script>
    <script src="https://cdn.ons.gov.uk/vendor/jquery/1.12.4/jquery.min.js"></script>
    <script src="../lib/modernizr.svg.min.js" type="text/javascript"></script>
    <script src="https://cdn.ons.gov.uk/vendor/pym/1.3.2/pym.min.js" type="text/javascript"></script>
    <script src="../lib/footer.js"></script>
    <script src="https://cdn.ons.gov.uk/vendor/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../lib/saveSvgAsPng.js" type="text/javascript"></script>
    <script src="js/chosen.jquery.js"></script>
    <script src="js/odometer.min.js" charset="utf-8"></script>
 
    
    <script>
    //╭━━╮╱╱╱╱╱╱╱╱╭╮
	//╰┫┣╯╱╱╱╱╱╱╱╭╯╰╮
	//╱┃┃╭━╮╭━━┳╮┣╮╭╋━━╮
	//╱┃┃┃╭╮┫╭╮┃┃┃┃┃┃━━┫
	//╭┫┣┫┃┃┃╰╯┃╰╯┃╰╋━━┃
	//╰━━┻╯╰┫╭━┻━━┻━┻━━╯
	//╱╱╱╱╱╱┃┃
	//╱╱╱╱╱╱╰╯

		var graphic = d3.select('#graphic');
		var graphic2 = d3.select('#graphic2');
		var graphic3 = d3.select('#graphic3');
		var graphic4 = d3.select('#graphic4');
		var graphic5 = d3.select('#graphic5');
		var graphic6 = d3.select('#graphic6');
		var graphic7 = d3.select('#graphic7');
		var keypoints = d3.select('#keypoints');
		var footer = d3.select(".footer");
		var pymChild = null;
		var numberFormat = d3.format(",d");
		var LAname = "Fareham";
		var AreaLoad = "Fareham";
		var filtereddata = "X";
		var filtereddataEngland = "X";
		var graphic_data = "X";
		var AreaLoad4 = "Fareham";
		var width = null;
		var substringUpdateTo = null;
		var dontsweep = false;
		var selectarea2 = null;
		var solidSelected = "Fareham";

		var updateTheChart = "yep";

		//old axis scales for config min-max
		//"xAxisScale":[[9.5,26.8],[44.8,69.8],[36.5,62.8],[379.4,1223.2],[54,71.1],[52.4,71.1]],


			//╭━━╮╱╱╱╱╱╱╱╱╭╮
	//╰┫┣╯╱╱╱╱╱╱╱╭╯╰╮
	//╱┃┃╭━╮╭━━┳╮┣╮╭╋━━╮
	//╱┃┃┃╭╮┫╭╮┃┃┃┃┃┃━━┫
	//╭┫┣┫┃┃┃╰╯┃╰╯┃╰╋━━┃
	//╰━━┻╯╰┫╭━┻━━┻━┻━━╯
	//╱╱╱╱╱╱┃┃
	//╱╱╱╱╱╱╰╯

	$("#pcError").hide();
	$("#successMessage").hide();
	$("#pcGo").click(function( event ) {
		//console.log("helloyou");
			//	event.preventDefault();
			//	event.stopPropagation();
				myValue = $("#pcText").val();
				myValue = myValue.toUpperCase();
					//manual method for area lookup
					myValue2 = myValue.replace(/\s+/g, '');
					getCodes1(myValue2);
					console.log(myValue2);
	});
	$("#pcText").keypress(function( event ) {
		if (event.which == 13) {
				event.preventDefault();
				event.stopPropagation();
				myValue = $("#pcText").val();
				myValue = myValue.toUpperCase();
					//manual method for area lookup
					myValue2 = myValue.replace(/\s+/g, '');
					getCodes1(myValue2);
					console.log(myValue2);
		}
	});

function getCodes1(myValue2)    {
    var myURIstring=encodeURI("https://api.postcodes.io/postcodes/"+myValue2);
    $.support.cors = true;
    $.ajax({
        type: "GET",
        crossDomain: true,
        dataType: "jsonp",
        url: myURIstring,
        error: function (xhr, ajaxOptions, thrownError) {
               $("#pcError").text("Sorry, that's not a valid postcode. Try an English or Welsh postcode eg PO15 5RR.").show();
            },
        success: function(data1){
            if(data1.status == 200 ){


                $("#pcError").hide();

				laCode =data1.result.admin_district;
				laCode =laCode.replace(/\s+/g, '');
				laCode =laCode.replace('-','');
				laCode =laCode.replace(',', '');
				laCode =laCode.replace(';', '');
				laCode =laCode.replace("'", '');
				pcodeUpdate = laCode;

				$("#occselect").val(pcodeUpdate);
				$("#occselect").trigger("chosen:updated");


				console.log(laCode);

				filtereddata = graphic_data.filter(function(d) {return d.name2 == laCode;});

									updateTheChart = "yep";
									calculate();

                //LAname = data1.result.admin_district;

				//fire the function returning statistics
				//drawStats();

				//gotoArea(data1.result.latitude,data1.result.longitude);


            } else {
      $("#successMessage").hide();
               $("#pcError").text("Sorry, that's not a valid postcode. Try an English or Welsh postcode eg PO15 5RR.").show();
            }
        }
    });
}










		window.odometerOptions = {
			  format: '(,ddd)',
			  duration: 500, // Change how long the javascript expects the CSS animation to take
		};


		function occopt () {

		//Create a chosen drop down to show the list of occupations

		dvc.allOcc = [];

		//Create an array for each occupation title
		graphic_data.forEach(function(d,i){
				dvc.allOcc.push(graphic_data[i].name);
		});

		dvc.allCode = [];

		//Create an array for each occupation code
		graphic_data.forEach(function(d,i){
				dvc.allCode.push(graphic_data[i].name2);
		});

		// Join occupation and codes together in an array
		var codeoccyzip = d3.zip(dvc.allOcc, dvc.allCode);


		//sort occupation list alphabetically
		dvc.codeoccyzip = codeoccyzip.sort(function(b, a){ return d3.descending(a[0], b[0])});


		// Build option menu for occupations
		var optns = d3.select("#occupation").append("div").attr("id","sel").append("select")
				.attr("id","occselect")
				.attr("style","width:95%")
				.attr("style","margin-left:10px;")
				.style("margin-left","20px")
				.attr("class","chosen-select");

			//append message

			optns.append("option")
				.attr("value","first")
				.text("");

			optns.selectAll("p").data(dvc.codeoccyzip).enter().append("option")
				.attr("value", function(d){ return d[1]})
				.text(function(d){ return d[0]});


			// Little function to bring objects to the front
			d3.selection.prototype.moveToFront = function() {
			  return this.each(function() {
				this.parentNode.appendChild(this)
			  });
			};


			$('#occselect').chosen({width: "60%", allow_single_deselect: true, placeholder_text_single:"or choose your area"}).on('change',function(evt,params){

								if(typeof params != 'undefined') {

									AreaLoad = params.selected;

									solidSelected = params.selected;

									AreaLoad2 = AreaLoad.replace(/\s/g,'');
									AreaLoad3 = AreaLoad2.replace(',','');
									AreaLoad4 = AreaLoad3.replace('-','');
									AreaLoad4 = AreaLoad4.replace('-','');

									filtereddata = graphic_data.filter(function(d) {return d.name2 == AreaLoad;});

									updateTheChart = "yep";
									calculate();

								}
								else {


								}

			});


	} //End of make occupation

	//   ____      _      _        ____      ____    ___    ____    _____
	//  / ___|    / \    | |      / ___|    / ___|  / _ \  |  _ \  | ____|
	// | |       / _ \   | |     | |       | |     | | | | | | | | |  _|
	// | |___   / ___ \  | |___  | |___    | |___  | |_| | | |_| | | |___
	//  \____| /_/   \_\ |_____|  \____|    \____|  \___/  |____/  |_____|
	//


	var TimesBy = 25;
	var price = null;
	var avPrice = 2363;
	var yourSizeAverage = null;
	var TopLA = 17988;
	var BotLA = 775;
	var fromPrice = 0;


	//these functions deal with the user's inputs
	d3.select(".smExtension").on("click",function(){
		TimesBy = 15;
		document.getElementById("custom2").value = TimesBy;
			updateTheChart = "nope";
		calculate();
	})
	d3.select(".mdExtension").on("click",function(){
		TimesBy = 25;
		document.getElementById("custom2").value = TimesBy;
			updateTheChart = "nope";
		calculate();
	})
	d3.select(".lgExtension").on("click",function(){
		TimesBy = 35;
		document.getElementById("custom2").value = TimesBy;
			updateTheChart = "nope";
		calculate();
	})


	d3.select("#custom2").on("change",function(){
		TimesByCustom = $("#custom2").val();
		TimesBy = TimesByCustom;
			updateTheChart = "nope";
		calculate();
			$('.smExtension').attr('checked', false);
			$('.mdExtension').attr('checked', false);
			$('.lgExtension').attr('checked', false);
	}).on("keyup", function(){
		TimesByCustom = $("#custom2").val();
		TimesBy = TimesByCustom;
			updateTheChart = "nope";
		calculate();
			$('.smExtension').attr('checked', false);
			$('.mdExtension').attr('checked', false);
			$('.lgExtension').attr('checked', false);
	});

	//array of numbers bit
	d3.select("#yourAreaValue").html(numberFormat(34272));
	d3.select("#EWAreaValue").html(numberFormat(28356));
//	d3.select("#TopAreaValue").html(numberFormat(215856));
//	d3.select("#BotAreaValue").html(numberFormat(9300));
	//chart bit
	d3.select("#yourAreaM2Value").html(numberFormat(2856));







	function calculate(){
		price = filtereddata[0].Area;
		LAname = filtereddata[0].name;

		d3.select("#yourAreaName").html(LAname);
		d3.select("#m2AreaName").html(LAname + " ");

		Yr_Value = TimesBy*price;
			d3.select("#yourAreaValue").html(numberFormat(Yr_Value));
		Av_Value = TimesBy*2363;
			d3.select("#EWAreaValue").html(numberFormat(Av_Value));
//		Hi_Value = TimesBy*17988;
//			d3.select("#TopAreaValue").html(numberFormat(Hi_Value));
//		Lo_Value = TimesBy*775;
//			d3.select("#BotAreaValue").html(numberFormat(Lo_Value));

			d3.select("#yourAreaM2Value").html(numberFormat(price));

		if (updateTheChart == "yep"){drawGraphic();}


	};




graphic = $(".resultsChart");
function drawGraphic() {

	graphic.empty();



			barheight = 40;
			margin = {}
			margin.left = 0;
			margin.right = 0;
			margin.top = 0;
			margin.bottom = 105;
			graphic_width = graphic.width() - margin.left - margin.right;

			var height = barheight + margin.top + margin.bottom;

			var data = [price];

			var x = d3.scale.linear()
				.domain([0,17988])
				.range([0,graphic_width - 2]);

			var chart = d3.select(".resultsChart")
				.attr("width", graphic_width)
				.attr("height", height)
				.attr("margin-right","10px;");


			var bar = chart.append("svg")
				.attr("width", graphic_width)
				.attr("height", height)
				.attr("id","chartAreaStuff");

			//Reset the text value to 0 so it animates up
			d3.select("#incomeOfNumber").text("");

			//grey backing
			bar.append("rect")
				.attr("width", function(d) { return x(17988); })
				.attr("height", barheight)
				.attr("transform","translate(0,30)")
				.attr("fill","#f4f4f4");

			//data bar
			bar.append("rect")
				.attr("width",fromPrice)
				.attr("height", barheight)
				.attr("transform","translate(0,30)")
				.attr("fill","#206095")
				.transition().duration(1000).attr("width", function(d) { return x(price); });

				fromPrice = price;

			//average bar
			bar.append("rect")
				.attr("width","3")
				.attr("height", barheight + 25)
				.attr("transform","translate(" + x(2363) + ",5)")
				.attr("fill","#B8860B");

			//Lowest
			bar.append("rect")
				.attr("width","3")
				.attr("height", barheight + 50)
				.attr("transform","translate(" + x(775) + ",30)")
				.attr("fill","#B8860B");

			//Highest
			bar.append("rect")
				.attr("width","3")
				.attr("height", barheight + 75)
				.attr("transform","translate(" + x(17988) + ",30)")
				.attr("fill","#B8860B");




			//average text
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("E&W average (£" + numberFormat(2363) + ")")
							.attr("x", function(d) { return x(2363) + 10 })
							.attr("y","20")
							.attr("text-anchor","start")
							.attr("font-size","16px")
							.attr("font-weight","bold")
							.attr("fill","#B8860B")
							.attr("id","EWAverageText");
			//Lo text
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("Blaenau Gwent (£775)")
							.attr("x", function(d) { return x(775) + 10 })
							.attr("y","115")
							.attr("text-anchor","start")
							.attr("font-size","16px")
							.attr("font-weight","bold")
							.attr("fill","#B8860B")
							.attr("id","EWAverageText");
			//Hi text
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("Kensington and Chelsea (£17,988)")
							.attr("x", function(d) { return x(17988) - 10 })
							.attr("y","140")
							.attr("text-anchor","end")
							.attr("font-size","16px")
							.attr("font-weight","bold")
							.attr("fill","#B8860B")
							.attr("id","EWAverageText");



			//axis text
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("£0")
							.attr("x","0")
							.attr("y","95")
							.attr("text-anchor","start")
							.attr("font-size","14px")
							.attr("fill","grey");

			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("£5k")
							.attr("x", function(d) { return x(5000) })
							.attr("y","95")
							.attr("text-anchor","middle")
							.attr("font-size","14px")
							.attr("fill","grey");
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("£10k")
							.attr("x", function(d) { return x(10000) })
							.attr("y","95")
							.attr("text-anchor","middle")
							.attr("font-size","14px")
							.attr("fill","grey");
			var text = d3.select("#chartAreaStuff")
                        .append("text")
							.text("£15k")
							.attr("x", function(d) { return x(15000) })
							.attr("y","95")
							.attr("text-anchor","middle")
							.attr("font-size","14px")
							.attr("fill","grey");

			//var text = d3.select("#chartAreaStuff")
//                        .append("text")
//							.text("£17,988")
//							.attr("x", function(d) { return x(17988) })
//							.attr("y","95")
//							.attr("text-anchor","end")
//							.attr("font-size","14px")
//							.attr("fill","grey");

			//axis tick marks
			bar.append("rect")
				.attr("width","1")
				.attr("height", 10)
				.attr("transform","translate(" + x(0) + ",70)")
				.attr("fill","#dadada");
			bar.append("rect")
				.attr("width","1")
				.attr("height", 10)
				.attr("transform","translate(" + x(5000) + ",70)")
				.attr("fill","#dadada");
			bar.append("rect")
				.attr("width","1")
				.attr("height", 10)
				.attr("transform","translate(" + x(10000) + ",70)")
				.attr("fill","#dadada");
			bar.append("rect")
				.attr("width","1")
				.attr("height", 10)
				.attr("transform","translate(" + x(15000) + ",70)")
				.attr("fill","#dadada");
			//bar.append("rect")
//				.attr("width","1")
//				.attr("height", 10)
//				.attr("transform","translate(" + x(17900) + ",70)")
//				.attr("fill","#dadada");

			setTimeout(function() {fromPrice = x(price)},1500);



			//use pym to calculate dimensions
		   if (pymChild) {
		       pymChild.sendHeight();
		   }
}


										if (Modernizr.svg) {
										   //load config
											d3.json("config.json", function(error, config) {
											dvc=config

												//load chart data
												d3.csv( dvc.essential.graphic_data_url, function(error, data) {
													graphic_data = data;

													filtereddata = data.filter(function(d) {return d.name == AreaLoad;});
													filtereddataEngland = graphic_data.filter(function(d) {return d.name == "England";});




													// graphic_data.forEach(function(d) {
													// 	d.name = d3.time.format(dvc.essential.dateFormat).parse(d.name);

													// });

													names = d3.keys(/*data*/graphic_data[0]).filter(function(key) { return key !== "state"; });

													/*data*/graphic_data.forEach(function(d) {
													  d.ages = names.map(function(name) { return {name: name, value: +d[name]}; });
													});

														//use pym to create iframed chart dependent on specified variables
														pymChild = new pym.Child({ renderCallback: calculate
														});
														occopt();
													});
											})

										} else {
											 //use pym to create iframe containing fallback image (which is set as default)
											 pymChild = new pym.Child();
											if (pymChild) {
												pymChild.sendHeight();
											}
										}


			var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-37894017-1']);
		  _gaq.push(['_trackPageview']);


		  (function() {

			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();





    </script>
</body>
</html>
