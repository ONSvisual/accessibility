<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="description" content="">
<!--<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />-->

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600|Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
<title>Untitled Document</title>

<style>

body {
  margin-left:0px;
  padding: 0px;
  display: block;
  max-width:800px;
  color:#fff;
  font-family: 'Open Sans', sans-serif;
  min-height:500px;
}

form {
  position: absolute;
  right: 10px;
  top: 10px;
}

.node {
    border: solid 1px white;
    line-height: 1;
    overflow: hidden;
    position: absolute;
    border-radius: 2px;
/*    background-image: -webkit-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:    -moz-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:     -ms-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:      -o-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:         linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    text-shadow: -1px -1px 2px hsla(0,0%,100%,0.25),
        -1px -1px 2px hsla(0,0%,100%,0.25),
        -1px 1px 2px hsla(0,0%,100%,0.25),
        1px -1px 2px hsla(0,0%,100%,0.25),
        -1px 0px 2px hsla(0,0%,100%,0.25),
        1px 0px 2px hsla(0,0%,100%,0.25);
*/}

.node div {
   padding: 6px 4%;
}


#leftdiv {
	width:100%;
	float:left;
	height:400px;
	position:relative;
	padding-bottom:0px;
	display:block;
}

/*#rightdiv {
	width:calc(50% - 6px);
	float:right;
	position:relative;
	height:440px;
	display:block;
}*/



#left {
	width:100%;
	float:left;
	height:400px;
	position:relative;
}

/*#right {
	width:100%;
	float:right;
	position:relative;
	height:400px;

}*/


/*#lefttext {
	width:100%;
	float:left;
	color:#666;
	display:block;
}

#righttext {
	width:100%;
	float:right;
	color:#666;
}*/


.footer  /* required */
{
  width:100%;
  font-size: 14px;
	color: #808080;
	font-weight:100;
	padding-bottom:15px;
  display: block;
  float: left;
  clear: left;
}


a, /* required */
a:link,
a:visited
{
	color: #4774CC;
	text-decoration: none;
}



a:hover, /* required */
a:active
{
	opacity: 0.7;
}

#country6.node {
  background-color: #B8860B ;
  /*color: black;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;

  border-top: solid 7px white;
  border-left: solid 7px white;
  border-bottom: solid 6px white;
  border-right: solid 6px white;
*/
 /*border-color: red;*/
}


@media (max-width: 610px) {

	#leftdiv {
		width:100%;
		/*float:left;*/
	}

	/*#rightdiv {
		width:100%;
		float:right;
	}*/

	.footer {
		width: 100%;
	}
}


#fallback{
	max-width:800px;
}
</style>

</head>

<body>

 


 <div id="leftdiv">    
 <div id="lefttext">
 <img id= "fallback" src="images/alt.png" alt="[Chart]"/>
</div>
</div>


<!-- <div id="rightdiv">
<div id="righttext">
Female
</div>

</div> -->

<div class="footer">
<p>Source: <a href="https://www.ons.gov.uk/releases/housepricepersquaremeterandhousepriceperroomenglandandwales2004to2016" target="_blank">House price per square metre and house price per room, England and Wales: 2004 to 2016, </a>
<a href="http://www.gov.scot/Topics/Statistics/SHCS" target="_blank">Scottish Government, </a>
<a href="https://www.census.gov/construction/chars/pdf/c25ann2016.pdf" target="_blank">United States Census Bureau.</a>
</div>


    <script src="https://cdn.ons.gov.uk/vendor/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.ons.gov.uk/vendor/d3/3.5.17/d3.min.js" type="text/javascript"></script>
    <script src="../lib/modernizr.svg.min.js" type="text/javascript"></script>
    <script src="https://cdn.ons.gov.uk/vendor/pym/1.3.2/pym.min.js" type="text/javascript"></script>

    <script>


var pymChild = null;

//pymChild = new pym.Child({ renderCallback: drawGraphic});


function drawGraphic() {

d3.select("#lefttext").remove();
d3.select("#left").remove();
// d3.select("#right").remove();


var treeleft = {
    name: "tree",
    children: [
		{ name: "Romania", size: 45 },
        { name: "Latvia", size: 63 },
        { name: "Lithuania", size: 63 },
        { name: "Ireland", size: 81 },
        { name: "Greece", size: 89 },
        { name: "England and Wales", size: 90 },
        { name: "Italy", size: 94 },
        { name: 'France', size: 94 },
        { name: 'Germany', size: 94 },
        { name: 'Scotland', size: 96 },
        { name: 'Spain', size: 99 },
        { name: 'Portugal', size: 106 },
        { name: 'Luxembourg', size: 131 },
        { name: 'Cyprus', size: 141 },
        { name: 'USA', size: 245 }
    ]
};

// var treeright = {
//     name: "tree",
//     children: [
//       { name: "Romania", size: 45 },
//           { name: "Latvia", size: 63 },
//           { name: "Lithuania", size: 63 },
//           { name: "Ireland", size: 81 },
//           { name: "Greece", size: 89 },
//           { name: "England and Wales", size: 90 },
//           { name: "Italy", size: 94 },
//           { name: 'France', size: 94 },
//           { name: 'Germany', size: 94 },
//           { name: 'Scotland', size: 96 },
//           { name: 'Spain', size: 99 },
//           { name: 'Portugal', size: 106 },
//           { name: 'Luxembourg', size: 131 },
//           { name: 'Cyprus', size: 141 },
//           { name: 'USA', size: 245 }
//     ]
// };

var height = 400,
    color = d3.scale.category20c(),
	//color = ["#6baed6","#3182bd","#08519c","#fdbe85"],

    divleft = d3.select("#leftdiv").append("div").attr("id","left")
      // .style("position", "relative");

    // divright = d3.select("#rightdiv").append("div").attr("id","right")
      // .style("position", "relative");


var width = $("#left").width();

colour = d3.scale.ordinal()
    .range(["#003C57"]);

// colour1 = d3.scale.ordinal()
//     .range(["#f768a1","#c51b8a","#7a0177","#74c476"]);

var treemapleft = d3.layout.treemap()
    .size([width, height])
    .sticky(true)
    .value(function(d) { return d.size+20; });

var node = divleft.datum(treeleft).selectAll(".node")
      .data(treemapleft.nodes)
    .enter().append("div")
	  .attr('id', function(d,i) { return "country" + i })
      .attr("class", "node")
      .call(position)
	  .style("background-color", function(d) {
        if (d.name === 'England and Wales') { return d.name == "#B8860B";}
        else { return d.name == 'tree' ? '#fff' : colour(d.name); }
      })
	  .append('div')
      .style("font-size", function(d) {
          // compute font size based on sqrt(area)
          return Math.max(20, 0.18*Math.sqrt(d.area)) -9 +'px'; })
      .html(function(d) { return d.children ? null : d.name + "<br>" + d.size.toLocaleString() + "m" + "<sup>" + 2 + "</sup>"; });

// var treemapright = d3.layout.treemap()
//     .size([width, height])
//     .sticky(true)
//     .value(function(d) { return d.size; });
//
// var node = divright.datum(treeright).selectAll(".node")
//       .data(treemapright.nodes)
//     .enter().append("div")
//       .attr("class", "node")
//       .call(position)
//       .style("background-color", function(d) {
//           return d.name == 'tree' ? '#fff' : colour1(d.name); })
//       .append('div')
//       .style("font-size", function(d) {
//           // compute font size based on sqrt(area)
//           return Math.max(20, 0.18*Math.sqrt(d.area)) -5+'px'; })
//       .html(function(d) { return d.children ? null : d.name + "<br>" + d.size.toLocaleString(); });

d3.select("body").style("height", "500px")

			if (pymChild) {
		        pymChild.sendHeight();
			console.log("pym");	
		    }


function position() {
	console.log(this);
  this.style("left", function(d) { return d.x + "px"; })
      .style("top", function(d) { return d.y + "px"; })
      .style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
      .style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
}


}


//if(Modernizr.svg){
//	d3.select("#graphic").remove();
//	pymChild = new pymChild({renderCallback : drawGraphic});
//	
//} else {
//	d3.select("#tree").remove();
//	pymChild = new pymChild();
//	if(pymChild){
//		pymChild.sendHeight();
//	}
//}

//check whether browser can cope with svg	
		if (Modernizr.svg ==true) {
					//use pym to create iframed chart dependent on specified variables
					
					
					pymChild = new pym.Child({ renderCallback: drawGraphic});
				
		

		} else {
			
			 //use pym to create iframe containing fallback image (which is set as default)
			 pymChild = new pym.Child();
			if (pymChild) {
		        pymChild.sendHeight();
		    }
		}
    </script>


</body>
</html>
